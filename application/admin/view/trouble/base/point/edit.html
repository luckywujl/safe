<form id="edit-form" class="form-horizontal" role="form" data-toggle="validator" method="POST" action="">

    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">{:__('Point_code')}:</label>
        <div class="col-xs-12 col-sm-8" hidden="hidden">
            <input id="c-id" data-rule="required" class="form-control" name="row[id]" type="text" value="{$row.id|htmlentities}">
            
        </div>
        <div class="col-xs-12 col-sm-8">
            <input id="c-point_code" data-rule="required" class="form-control" name="row[point_code]" type="text" value="{$row.point_code|htmlentities}">
            
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">{:__('Point_name')}:</label>
        <div class="col-xs-12 col-sm-8">
            <input id="c-point_name" class="form-control" name="row[point_name]" type="text" value="{$row.point_name|htmlentities}">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">{:__('Point_description')}:</label>
        <div class="col-xs-12 col-sm-8">
            <input id="c-point_description" class="form-control" name="row[point_description]" type="text" value="{$row.point_description|htmlentities}">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">{:__('Point_address')}:</label>
        <div class="col-xs-12 col-sm-8">
            <input id="c-point_address" class="form-control" name="row[point_address]" type="text" value="{$row.point_address|htmlentities}">
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">{:__('Point_position')}:</label>
        <div class="col-xs-12 col-sm-8">
            <input id="c-point_position" class="form-control" name="row[point_position]" type="text" value="{$row.point_position|htmlentities}">
        </div>
    </div>
     <div class="form-group">
        <label for="c-pid" class="control-label col-xs-12 col-sm-2">{:__('Point_department_id')}:</label>
        <div class="col-xs-12 col-sm-8">
            <select id="c-point_department_id" data-rule="required" class="form-control selectpicker" name="row[point_department_id]">
                {foreach name="parentList" item="vo"}
                <option data-type="{$vo.type}" value="{$key}" {in name="key" value="$row.point_department_id"}selected{/in}>{$vo.name}</option>
                
                {/foreach}
            </select>
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2">{:__('Point_area_id')}:</label>
        <div class="col-xs-12 col-sm-8">
            <input id="c-point_area_id" data-rule="required" data-source="trouble/base/area/index" data-field="area_name" data-primary-key="id" class="form-control selectpage" name="row[point_area_id]" type="text" value="{$row.point_area_id|htmlentities}">
        </div>
    </div>
    <div class="col-xs-12 col-sm-8" hidden="hidden">
            <input id="c-company_id" class="form-control" name="row[company_id]" type="text" value="{$row.company_id|htmlentities}">
        </div>
    <div class="form-group user-select ">
      <label class="control-label col-xs-12 col-sm-2">隐患点报警码:</label>
   	<div class="col-xs-12 col-sm-8">
    		<img src="" alt="" id='qrcodeimg' />
    		
    	</div>
   </div>
    
    <div class="form-group layer-footer">
        <label class="control-label col-xs-12 col-sm-2"></label>
        <div class="col-xs-12 col-sm-8">
            <button type="submit" class="btn btn-success btn-embossed disabled">{:__('OK')}</button>
            <button type="reset" class="btn btn-default btn-embossed">{:__('Reset')}</button>
        </div>
    </div>
</form>
<script src="__CDN__/assets/libs/jquery/dist/jquery.min.js"></script>
<script type="text/javascript">
            $(function () {
                $("form").submit(function () {
                	 var t = 'http://192.168.0.4:9010/addons/trouble/index/report.html?point_id='+$("#c-id").val();
                	// var t = 'http://safe.haxxj.com/addons/trouble/index/report.html?point_id='+$("#c-id").val();
                    $("#qrcodeimg").prop("src", "{:addon_url('qrcode/index/build',[],false)}?" + 'label='+'('+$("#c-point_code").val()+')'+$("#c-point_name").val()+'&logo=1&logopath=.'+$("#c-coverimage").val()+'&text='+t+'&company='+$("#c-company_id").val()+'&code='+$("#c-point_code").val()+'&write=1');;
                    return false;
                });
                $("form").trigger('submit');
            });
</script>
